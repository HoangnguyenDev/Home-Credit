// Financial Health Dashboard Feature // Provides comprehensive financial health analysis and recommendations class FinancialHealthDashboard { constructor() { this.userData = null; this.healthScore = 0; this.recommendations = []; this.loadUserData(); } // Load user financial data from storage async loadUserData() { if (chrome && chrome.storage) { const result = await chrome.storage.local.get(['financialData']); this.userData = result.financialData || this.getDefaultData(); } else { this.userData = this.getDefaultData(); } this.calculateHealthScore(); } // Get default financial data structure getDefaultData() { return { income: { monthly: 0, sources: ['salary'], stable: true }, expenses: { monthly: 0, categories: { housing: 0, food: 0, transportation: 0, utilities: 0, entertainment: 0, debt: 0, savings: 0, other: 0 } }, debts: { total: 0, items: [] }, savings: { emergency: 0, investment: 0, goals: [] }, goals: { shortTerm: [], longTerm: [] }, lastUpdated: new Date().toISOString() }; } // Calculate financial health score (0-100) calculateHealthScore() { let score = 0; const weights = { debtToIncome: 25, emergencyFund: 20, savingsRate: 20, expenseRatio: 15, diversification: 10, goals: 10 }; // Debt-to-income ratio (lower is better) const debtToIncomeRatio = this.userData.debts.total / (this.userData.income.monthly * 12); if (debtToIncomeRatio <= 0.2) score += weights.debtToIncome; else if (debtToIncomeRatio <= 0.36) score += weights.debtToIncome * 0.7; else if (debtToIncomeRatio <= 0.5) score += weights.debtToIncome * 0.4; // Emergency fund (3-6 months of expenses) const monthlyExpenses = this.userData.expenses.monthly; const emergencyMonths = this.userData.savings.emergency / monthlyExpenses; if (emergencyMonths >= 6) score += weights.emergencyFund; else if (emergencyMonths >= 3) score += weights.emergencyFund * 0.8; else if (emergencyMonths >= 1) score += weights.emergencyFund * 0.5; // Savings rate (income - expenses) / income const savingsRate = (this.userData.income.monthly - this.userData.expenses.monthly) / this.userData.income.monthly; if (savingsRate >= 0.2) score += weights.savingsRate; else if (savingsRate >= 0.1) score += weights.savingsRate * 0.7; else if (savingsRate >= 0.05) score += weights.savingsRate * 0.4; // Expense ratio control const expenseRatio = this.userData.expenses.monthly / this.userData.income.monthly; if (expenseRatio <= 0.5) score += weights.expenseRatio; else if (expenseRatio <= 0.7) score += weights.expenseRatio * 0.7; else if (expenseRatio <= 0.8) score += weights.expenseRatio * 0.4; // Income diversification if (this.userData.income.sources.length > 1) score += weights.diversification; else if (this.userData.income.stable) score += weights.diversification * 0.5; // Financial goals const totalGoals = this.userData.goals.shortTerm.length + this.userData.goals.longTerm.length; if (totalGoals >= 3) score += weights.goals; else if (totalGoals >= 1) score += weights.goals * 0.6; this.healthScore = Math.round(score); this.generateRecommendations(); } // Generate personalized recommendations generateRecommendations() { this.recommendations = []; const debtToIncomeRatio = this.userData.debts.total / (this.userData.income.monthly * 12); const emergencyMonths = this.userData.savings.emergency / this.userData.expenses.monthly; const savingsRate = (this.userData.income.monthly - this.userData.expenses.monthly) / this.userData.income.monthly; // Debt recommendations if (debtToIncomeRatio > 0.36) { this.recommendations.push({ type: 'debt', priority: 'high', title: 'Giáº£m ná»£ kháº©n cáº¥p', description: 'Tá»· lá»‡ ná»£/thu nháº­p cá»§a báº¡n cao. HÃ£y Æ°u tiÃªn tráº£ ná»£ lÃ£i suáº¥t cao trÆ°á»›c.', action: 'debt_consolidation', icon: 'ğŸš¨' }); } // Emergency fund recommendations if (emergencyMonths < 3) { this.recommendations.push({ type: 'emergency', priority: 'high', title: 'XÃ¢y dá»±ng quá»¹ kháº©n cáº¥p', description: `HÃ£y tiáº¿t kiá»‡m ${this.formatCurrency((3 * this.userData.expenses.monthly) - this.userData.savings.emergency)} Ä‘á»ƒ cÃ³ quá»¹ kháº©n cáº¥p 3 thÃ¡ng.`, action: 'emergency_fund', icon: 'ğŸ›¡ï¸' }); } // Savings recommendations if (savingsRate < 0.1) { this.recommendations.push({ type: 'savings', priority: 'medium', title: 'TÄƒng tá»· lá»‡ tiáº¿t kiá»‡m', description: 'Má»¥c tiÃªu tiáº¿t kiá»‡m Ã­t nháº¥t 10% thu nháº­p hÃ ng thÃ¡ng.', action: 'savings_plan', icon: 'ğŸ’°' }); } // Investment recommendations if (this.userData.savings.investment === 0 && emergencyMonths >= 3) { this.recommendations.push({ type: 'investment', priority: 'medium', title: 'Báº¯t Ä‘áº§u Ä‘áº§u tÆ°', description: 'Báº¡n Ä‘Ã£ cÃ³ quá»¹ kháº©n cáº¥p. HÃ£y xem xÃ©t Ä‘áº§u tÆ° Ä‘á»ƒ tÄƒng tÃ i sáº£n.', action: 'investment_start', icon: 'ğŸ“ˆ' }); } // Home Credit specific recommendations if (debtToIncomeRatio < 0.3 && this.userData.income.monthly > 15000000) { this.recommendations.push({ type: 'product', priority: 'low', title: 'Tháº» tÃ­n dá»¥ng Home Credit', description: 'Báº¡n Ä‘á»§ Ä‘iá»u kiá»‡n Ä‘Äƒng kÃ½ tháº» tÃ­n dá»¥ng vá»›i nhiá»u Æ°u Ä‘Ã£i.', action: 'credit_card_apply', icon: 'ğŸ’³' }); } // Sort by priority const priorityOrder = { 'high': 3, 'medium': 2, 'low': 1 }; this.recommendations.sort((a, b) => priorityOrder[b.priority] - priorityOrder[a.priority]); } // Create dashboard modal createDashboardModal() { const modal = document.createElement('div'); modal.className = 'hc-dashboard-modal hc-extension-reset'; modal.innerHTML = ` <div class="hc-dashboard-overlay" onclick="this.parentElement.remove()"></div> <div class="hc-dashboard-content"> <div class="hc-dashboard-header"> <h3>ğŸ“Š TÃ¬nh HÃ¬nh TÃ i ChÃ­nh Cá»§a Báº¡n</h3> <button class="hc-close-btn" onclick="this.closest('.hc-dashboard-modal').remove()">Ã—</button> </div> <div class="hc-dashboard-tabs"> <button class="hc-tab-btn active" data-tab="overview">Tá»•ng quan</button> <button class="hc-tab-btn" data-tab="analysis">PhÃ¢n tÃ­ch</button> <button class="hc-tab-btn" data-tab="recommendations">Khuyáº¿n nghá»‹</button> <button class="hc-tab-btn" data-tab="goals">Má»¥c tiÃªu</button> </div> <div class="hc-tab-content active" id="overview-tab"> ${this.createOverviewTab()} </div> <div class="hc-tab-content" id="analysis-tab"> ${this.createAnalysisTab()} </div> <div class="hc-tab-content" id="recommendations-tab"> ${this.createRecommendationsTab()} </div> <div class="hc-tab-content" id="goals-tab"> ${this.createGoalsTab()} </div> <div class="hc-dashboard-footer"> <button class="hc-update-data-btn" onclick="window.financialDashboard.showDataForm()"> ğŸ“ Cáº­p nháº­t thÃ´ng tin tÃ i chÃ­nh </button> </div> </div> `; return modal; } // Create overview tab content createOverviewTab() { const scoreColor = this.getScoreColor(this.healthScore); const scoreEmoji = this.getScoreEmoji(this.healthScore); return ` <div class="hc-health-score-card"> <div class="hc-score-circle" style="border-color: ${scoreColor}"> <span class="hc-score-emoji">${scoreEmoji}</span> <span class="hc-score-number" style="color: ${scoreColor}">${this.healthScore}</span> <span class="hc-score-label">Äiá»ƒm sá»©c khá»e tÃ i chÃ­nh</span> </div> <div class="hc-score-description"> <h4>${this.getScoreDescription(this.healthScore)}</h4> <p>${this.getScoreAdvice(this.healthScore)}</p> </div> </div> <div class="hc-overview-grid"> <div class="hc-overview-card"> <div class="hc-card-icon">ğŸ’µ</div> <div class="hc-card-content"> <div class="hc-card-title">Thu nháº­p thÃ¡ng</div> <div class="hc-card-value">${this.formatCurrency(this.userData.income.monthly)}</div> </div> </div> <div class="hc-overview-card"> <div class="hc-card-icon">ğŸ’¸</div> <div class="hc-card-content"> <div class="hc-card-title">Chi tiÃªu thÃ¡ng</div> <div class="hc-card-value">${this.formatCurrency(this.userData.expenses.monthly)}</div> </div> </div> <div class="hc-overview-card"> <div class="hc-card-icon">ğŸ’°</div> <div class="hc-card-content"> <div class="hc-card-title">Tiáº¿t kiá»‡m thÃ¡ng</div> <div class="hc-card-value">${this.formatCurrency(this.userData.income.monthly - this.userData.expenses.monthly)}</div> </div> </div> <div class="hc-overview-card"> <div class="hc-card-icon">ğŸ”’</div> <div class="hc-card-content"> <div class="hc-card-title">Quá»¹ kháº©n cáº¥p</div> <div class="hc-card-value">${this.formatCurrency(this.userData.savings.emergency)}</div> </div> </div> <div class="hc-overview-card"> <div class="hc-card-icon">ğŸ“ˆ</div> <div class="hc-card-content"> <div class="hc-card-title">Äáº§u tÆ°</div> <div class="hc-card-value">${this.formatCurrency(this.userData.savings.investment)}</div> </div> </div> <div class="hc-overview-card"> <div class="hc-card-icon">ğŸ’³</div> <div class="hc-card-content"> <div class="hc-card-title">Tá»•ng ná»£</div> <div class="hc-card-value">${this.formatCurrency(this.userData.debts.total)}</div> </div> </div> </div> `; } // Create analysis tab content createAnalysisTab() { const debtToIncomeRatio = this.userData.debts.total / (this.userData.income.monthly * 12); const emergencyMonths = this.userData.savings.emergency / this.userData.expenses.monthly; const savingsRate = (this.userData.income.monthly - this.userData.expenses.monthly) / this.userData.income.monthly; return ` <div class="hc-analysis-section"> <h4>ğŸ“Š PhÃ¢n tÃ­ch chi tiáº¿t</h4> <div class="hc-metric-card"> <div class="hc-metric-header"> <span class="hc-metric-title">Tá»· lá»‡ Ná»£/Thu nháº­p</span> <span class="hc-metric-status ${debtToIncomeRatio <= 0.36 ? 'good' : debtToIncomeRatio <= 0.5 ? 'warning' : 'danger'}"> ${debtToIncomeRatio <= 0.36 ? 'âœ… Tá»‘t' : debtToIncomeRatio <= 0.5 ? 'âš ï¸ Cáº£nh bÃ¡o' : 'ğŸš¨ Nguy hiá»ƒm'} </span> </div> <div class="hc-metric-value">${(debtToIncomeRatio * 100).toFixed(1)}%</div> <div class="hc-metric-bar"> <div class="hc-metric-fill" style="width: ${Math.min(debtToIncomeRatio * 100, 100)}%; background: ${debtToIncomeRatio <= 0.36 ? '#4CAF50' : debtToIncomeRatio <= 0.5 ? '#FFC107' : '#F44336'}"></div> </div> <div class="hc-metric-advice"> ${debtToIncomeRatio <= 0.36 ? 'Tá»· lá»‡ ná»£ cá»§a báº¡n á»Ÿ má»©c an toÃ n.' : 'HÃ£y xem xÃ©t giáº£m ná»£ Ä‘á»ƒ cáº£i thiá»‡n tÃ¬nh hÃ¬nh tÃ i chÃ­nh.'} </div> </div> <div class="hc-metric-card"> <div class="hc-metric-header"> <span class="hc-metric-title">Quá»¹ kháº©n cáº¥p</span> <span class="hc-metric-status ${emergencyMonths >= 6 ? 'good' : emergencyMonths >= 3 ? 'warning' : 'danger'}"> ${emergencyMonths >= 6 ? 'âœ… Tá»‘t' : emergencyMonths >= 3 ? 'âš ï¸ Táº¡m Ä‘á»§' : 'ğŸš¨ Thiáº¿u'} </span> </div> <div class="hc-metric-value">${emergencyMonths.toFixed(1)} thÃ¡ng</div> <div class="hc-metric-bar"> <div class="hc-metric-fill" style="width: ${Math.min((emergencyMonths / 6) * 100, 100)}%; background: ${emergencyMonths >= 6 ? '#4CAF50' : emergencyMonths >= 3 ? '#FFC107' : '#F44336'}"></div> </div> <div class="hc-metric-advice"> ${emergencyMonths >= 6 ? 'Quá»¹ kháº©n cáº¥p cá»§a báº¡n Ä‘Ã£ Ä‘á»§.' : `HÃ£y tiáº¿t kiá»‡m thÃªm ${this.formatCurrency((6 - emergencyMonths) * this.userData.expenses.monthly)} Ä‘á»ƒ Ä‘áº¡t má»¥c tiÃªu 6 thÃ¡ng.`} </div> </div> <div class="hc-metric-card"> <div class="hc-metric-header"> <span class="hc-metric-title">Tá»· lá»‡ tiáº¿t kiá»‡m</span> <span class="hc-metric-status ${savingsRate >= 0.2 ? 'good' : savingsRate >= 0.1 ? 'warning' : 'danger'}"> ${savingsRate >= 0.2 ? 'âœ… Xuáº¥t sáº¯c' : savingsRate >= 0.1 ? 'âš ï¸ Táº¡m Ä‘Æ°á»£c' : 'ğŸš¨ Cáº§n cáº£i thiá»‡n'} </span> </div> <div class="hc-metric-value">${(savingsRate * 100).toFixed(1)}%</div> <div class="hc-metric-bar"> <div class="hc-metric-fill" style="width: ${Math.min(savingsRate * 100, 100)}%; background: ${savingsRate >= 0.2 ? '#4CAF50' : savingsRate >= 0.1 ? '#FFC107' : '#F44336'}"></div> </div> <div class="hc-metric-advice"> ${savingsRate >= 0.2 ? 'Tá»· lá»‡ tiáº¿t kiá»‡m cá»§a báº¡n ráº¥t tá»‘t!' : 'HÃ£y cá»‘ gáº¯ng tiáº¿t kiá»‡m Ã­t nháº¥t 10% thu nháº­p hÃ ng thÃ¡ng.'} </div> </div> </div> <div class="hc-expenses-breakdown"> <h4>ğŸ’¸ PhÃ¢n tÃ­ch chi tiÃªu</h4> <div class="hc-expense-chart"> ${this.createExpenseChart()} </div> </div> `; } // Create recommendations tab content createRecommendationsTab() { if (this.recommendations.length === 0) { return ` <div class="hc-no-recommendations"> <div class="hc-success-icon">ğŸ‰</div> <h4>Tuyá»‡t vá»i!</h4> <p>TÃ¬nh hÃ¬nh tÃ i chÃ­nh cá»§a báº¡n Ä‘ang ráº¥t tá»‘t. KhÃ´ng cÃ³ khuyáº¿n nghá»‹ cáº¥p thiáº¿t nÃ o.</p> </div> `; } return ` <div class="hc-recommendations-list"> <h4>ğŸ’¡ Khuyáº¿n nghá»‹ cáº£i thiá»‡n</h4> ${this.recommendations.map(rec => ` <div class="hc-recommendation-card ${rec.priority}"> <div class="hc-rec-icon">${rec.icon}</div> <div class="hc-rec-content"> <div class="hc-rec-header"> <h5>${rec.title}</h5> <span class="hc-rec-priority">${rec.priority === 'high' ? 'Æ¯u tiÃªn cao' : rec.priority === 'medium' ? 'Æ¯u tiÃªn trung bÃ¬nh' : 'Gá»£i Ã½'}</span> </div> <p>${rec.description}</p> <button class="hc-rec-action" onclick="window.financialDashboard.executeRecommendation('${rec.action}')"> Thá»±c hiá»‡n ngay </button> </div> </div> `).join('')} </div> `; } // Create goals tab content createGoalsTab() { return ` <div class="hc-goals-section"> <h4>ğŸ¯ Má»¥c tiÃªu tÃ i chÃ­nh</h4> <div class="hc-goals-grid"> <div class="hc-goal-category"> <h5>Má»¥c tiÃªu ngáº¯n háº¡n (< 1 nÄƒm)</h5> <div class="hc-goals-list" id="short-term-goals"> ${this.userData.goals.shortTerm.map(goal => this.createGoalItem(goal)).join('')} </div> <button class="hc-add-goal-btn" onclick="window.financialDashboard.addGoal('shortTerm')"> + ThÃªm má»¥c tiÃªu ngáº¯n háº¡n </button> </div> <div class="hc-goal-category"> <h5>Má»¥c tiÃªu dÃ i háº¡n (> 1 nÄƒm)</h5> <div class="hc-goals-list" id="long-term-goals"> ${this.userData.goals.longTerm.map(goal => this.createGoalItem(goal)).join('')} </div> <button class="hc-add-goal-btn" onclick="window.financialDashboard.addGoal('longTerm')"> + ThÃªm má»¥c tiÃªu dÃ i háº¡n </button> </div> </div> <div class="hc-goal-suggestions"> <h5>ğŸ’­ Gá»£i Ã½ má»¥c tiÃªu phá»• biáº¿n</h5> <div class="hc-suggestion-buttons"> <button onclick="window.financialDashboard.addSuggestedGoal('emergency', 'shortTerm')">ğŸ›¡ï¸ Quá»¹ kháº©n cáº¥p</button> <button onclick="window.financialDashboard.addSuggestedGoal('house', 'longTerm')">ğŸ  Mua nhÃ </button> <button onclick="window.financialDashboard.addSuggestedGoal('car', 'shortTerm')">ğŸš— Mua xe</button> <button onclick="window.financialDashboard.addSuggestedGoal('vacation', 'shortTerm')">âœˆï¸ Du lá»‹ch</button> <button onclick="window.financialDashboard.addSuggestedGoal('retirement', 'longTerm')">ğŸ‘´ HÆ°u trÃ­</button> </div> </div> </div> `; } // Create goal item createGoalItem(goal) { const progress = Math.min((goal.saved / goal.target) * 100, 100); return ` <div class="hc-goal-item"> <div class="hc-goal-header"> <span class="hc-goal-name">${goal.name}</span> <span class="hc-goal-amount">${this.formatCurrency(goal.saved)} / ${this.formatCurrency(goal.target)}</span> </div> <div class="hc-goal-progress"> <div class="hc-goal-bar"> <div class="hc-goal-fill" style="width: ${progress}%"></div> </div> <span class="hc-goal-percent">${progress.toFixed(1)}%</span> </div> <div class="hc-goal-deadline">Má»¥c tiÃªu: ${new Date(goal.deadline).toLocaleDateString('vi-VN')}</div> </div> `; } // Create expense chart createExpenseChart() { const categories = this.userData.expenses.categories; const total = Object.values(categories).reduce((sum, amount) => sum + amount, 0); const colors = { housing: '#FF6B35', food: '#F7931E', transportation: '#4CAF50', utilities: '#2196F3', entertainment: '#9C27B0', debt: '#F44336', savings: '#4CAF50', other: '#795548' }; const labels = { housing: 'NhÃ  á»Ÿ', food: 'Ä‚n uá»‘ng', transportation: 'Di chuyá»ƒn', utilities: 'Tiá»‡n Ã­ch', entertainment: 'Giáº£i trÃ­', debt: 'Tráº£ ná»£', savings: 'Tiáº¿t kiá»‡m', other: 'KhÃ¡c' }; return Object.entries(categories) .filter(([, amount]) => amount > 0) .map(([category, amount]) => { const percentage = (amount / total) * 100; return ` <div class="hc-expense-item"> <div class="hc-expense-label"> <span class="hc-expense-color" style="background: ${colors[category]}"></span> <span class="hc-expense-name">${labels[category]}</span> </div> <div class="hc-expense-amount">${this.formatCurrency(amount)}</div> <div class="hc-expense-percent">${percentage.toFixed(1)}%</div> </div> `; }).join(''); } // Helper methods getScoreColor(score) { if (score >= 80) return '#4CAF50'; if (score >= 60) return '#FFC107'; if (score >= 40) return '#FF9800'; return '#F44336'; } getScoreEmoji(score) { if (score >= 80) return 'ğŸŒŸ'; if (score >= 60) return 'ğŸ˜Š'; if (score >= 40) return 'ğŸ˜'; return 'ğŸ˜Ÿ'; } getScoreDescription(score) { if (score >= 80) return 'Xuáº¥t sáº¯c!'; if (score >= 60) return 'Tá»‘t'; if (score >= 40) return 'Trung bÃ¬nh'; return 'Cáº§n cáº£i thiá»‡n'; } getScoreAdvice(score) { if (score >= 80) return 'TÃ¬nh hÃ¬nh tÃ i chÃ­nh cá»§a báº¡n ráº¥t tá»‘t. HÃ£y duy trÃ¬ vÃ  tiáº¿p tá»¥c phÃ¡t triá»ƒn.'; if (score >= 60) return 'Báº¡n Ä‘ang trÃªn Ä‘Æ°á»ng Ä‘Ãºng. HÃ£y thá»±c hiá»‡n má»™t vÃ i cáº£i thiá»‡n nhá».'; if (score >= 40) return 'CÃ³ má»™t sá»‘ váº¥n Ä‘á» cáº§n chÃº Ã½. HÃ£y táº­p trung vÃ o cÃ¡c khuyáº¿n nghá»‹ Æ°u tiÃªn cao.'; return 'TÃ¬nh hÃ¬nh tÃ i chÃ­nh cáº§n Ä‘Æ°á»£c cáº£i thiá»‡n ngay. HÃ£y báº¯t Ä‘áº§u vá»›i cÃ¡c bÆ°á»›c cÆ¡ báº£n.'; } formatCurrency(amount) { return new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND', minimumFractionDigits: 0 }).format(amount); } // Execute recommendation action executeRecommendation(action) { const actions = { debt_consolidation: () => { chrome.tabs.create({ url: 'https://www.homecredit.vn/vay-tien-mat' }); this.trackEvent('recommendation_executed', { action: 'debt_consolidation' }); }, emergency_fund: () => { this.showSavingsCalculator('emergency'); }, savings_plan: () => { this.showSavingsCalculator('general'); }, investment_start: () => { chrome.tabs.create({ url: 'https://www.homecredit.vn/dau-tu' }); this.trackEvent('recommendation_executed', { action: 'investment_start' }); }, credit_card_apply: () => { chrome.tabs.create({ url: 'https://www.homecredit.vn/the-tin-dung' }); this.trackEvent('recommendation_executed', { action: 'credit_card_apply' }); } }; if (actions[action]) { actions[action](); } } // Show data update form showDataForm() { // Implementation for data update form alert('TÃ­nh nÄƒng cáº­p nháº­t dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c triá»ƒn khai trong phiÃªn báº£n tiáº¿p theo.'); } // Add goal addGoal(type) { const name = prompt('TÃªn má»¥c tiÃªu:'); const target = parseFloat(prompt('Sá»‘ tiá»n má»¥c tiÃªu (VND):')); const deadline = prompt('Thá»i háº¡n (YYYY-MM-DD):'); if (name && target && deadline) { const goal = { id: Date.now(), name: name, target: target, saved: 0, deadline: deadline, created: new Date().toISOString() }; this.userData.goals[type].push(goal); this.saveUserData(); this.refreshDashboard(); } } // Add suggested goal addSuggestedGoal(suggestionType, goalType) { const suggestions = { emergency: { name: 'Quá»¹ kháº©n cáº¥p', target: this.userData.expenses.monthly * 6 }, house: { name: 'Mua nhÃ ', target: 2000000000 }, car: { name: 'Mua xe', target: 500000000 }, vacation: { name: 'Du lá»‹ch', target: 50000000 }, retirement: { name: 'HÆ°u trÃ­', target: 5000000000 } }; const suggestion = suggestions[suggestionType]; if (suggestion) { const deadline = goalType === 'shortTerm' ? new Date(Date.now() + 365 * 24 * 60 * 60 * 1000).toISOString().split('T')[0] : new Date(Date.now() + 5 * 365 * 24 * 60 * 60 * 1000).toISOString().split('T')[0]; const goal = { id: Date.now(), name: suggestion.name, target: suggestion.target, saved: 0, deadline: deadline, created: new Date().toISOString() }; this.userData.goals[goalType].push(goal); this.saveUserData(); this.refreshDashboard(); } } // Save user data async saveUserData() { if (chrome && chrome.storage) { await chrome.storage.local.set({ financialData: this.userData }); } } // Refresh dashboard refreshDashboard() { this.calculateHealthScore(); document.querySelector('.hc-dashboard-modal').remove(); this.show(); } // Track events trackEvent(eventName, data) { if (chrome && chrome.runtime) { chrome.runtime.sendMessage({ action: 'trackEvent', eventName: eventName, data: data }).catch(() => {}); } } // Setup event listeners setupEventListeners() { document.addEventListener('click', (e) => { if (e.target.classList.contains('hc-tab-btn')) { const tabName = e.target.dataset.tab; document.querySelectorAll('.hc-tab-btn').forEach(btn => btn.classList.remove('active')); document.querySelectorAll('.hc-tab-content').forEach(content => content.classList.remove('active')); e.target.classList.add('active'); document.getElementById(`${tabName}-tab`).classList.add('active'); } }); } // Show dashboard show() { const existing = document.querySelector('.hc-dashboard-modal'); if (existing) existing.remove(); const modal = this.createDashboardModal(); document.body.appendChild(modal); this.setupEventListeners(); this.trackEvent('financial_dashboard_opened', { healthScore: this.healthScore, recommendationsCount: this.recommendations.length }); } } // Initialize dashboard window.financialDashboard = new FinancialHealthDashboard();